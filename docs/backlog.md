# Project Backlog

| Epic | Task Description | Acceptance Criteria | Status | Prototype | Notes |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **CI/CD & Deployment** | Setup GitHub Actions workflow for CI/CD | - Compile project with GitHub Packages authentication<br>- Run all tests<br>- Create semantic version release<br>- Build Docker image with proper tagging<br>- Publish to GitHub Container Registry<br>- Only deploy on successful release | `Complete` |  | Updated .github/workflows/ci.yml with full CI/CD pipeline. Build-and-test job runs compile/test with GitHub Packages auth. Semantic release creates versions. Docker job builds and pushes to ghcr.io with semantic version tags. Dockerfile updated to accept build args for GitHub credentials. |
| **Testing & Quality** | Create comprehensive test suite for critical components | - Test domain models (ValueObjects, ScheduleRequest, ScheduleType, ScheduledMessage)<br>- Test API layer (ScheduleRequestParser)<br>- Test configuration validation<br>- All tests passing<br>- Good code coverage on business logic | `Complete` |  | Created 6 test specs with 54 tests covering domain, API, and config validation. All tests passing. Includes edge cases, validation, and error handling. |
| **Library Migration** | Migrate to Byrde commons logging library | - Replace scala-logging/logback with Byrde commons logging<br>- Update all logger instances across codebase<br>- Update build.sbt dependencies<br>- Verify structured logging works<br>- Test log output format | `Complete` |  | Successfully migrated to org.byrde.logging.ScalaLogger across Main, HealthCheckServer, DatabaseManager, MessageScheduler, and PubSubClient. Dependencies loaded from GitHub Packages. Compiles successfully. |
| **Library Migration** | Migrate to Byrde commons PubSub library | - Replace google-cloud-pubsub with Byrde commons pubsub<br>- Refactor PubSubClient to use commons API<br>- Refactor PubSubSubscriber to use commons API<br>- Update configuration for commons library<br>- Update build.sbt dependencies<br>- Verify subscriber and publisher work<br>- Update health checks if needed | `TODO` |  | Migrate from direct google-cloud-pubsub to https://github.com/Byrde/commons/tree/main/pubsub |
| **Pub/Sub Message Ingestion** | Implement Pub/Sub subscriber to receive schedule requests | - Subscriber connects to configured subscription<br>- Messages are acknowledged after processing<br>- Connection errors are logged and retried<br>- Manual CLI command to test subscription | `Ready to Test` |  | Implemented in PubSubSubscriber.scala |
| **Pub/Sub Message Ingestion** | Parse and validate incoming schedule request messages | - Parse JSON message body into ScheduleRequest domain model<br>- Validate execution time is in future<br>- Validate target topic format<br>- Validate payload is non-empty<br>- Return validation errors for invalid messages | `Ready to Test` |  | Implemented in ScheduleRequestParser.scala with Circe JSON parsing |
| **Database-Backed Scheduling** | Configure db-scheduler with Cloud SQL database support | - Support PostgreSQL, MySQL, and SQL Server via JDBC<br>- Initialize db-scheduler schema on startup<br>- Configure connection pooling<br>- Handle database connection failures gracefully | `Ready to Test` |  | Implemented with HikariCP in DatabaseManager.scala |
| **Database-Backed Scheduling** | Create scheduled tasks from validated schedule requests | - Convert ScheduleRequest to db-scheduler task<br>- Persist task to database with execution time<br>- Store target topic and payload in task data<br>- Return task ID for tracking | `Ready to Test` |  | Implemented in MessageScheduler.scala with JSON serialization |
| **Database-Backed Scheduling** | Implement task execution handler | - db-scheduler triggers handler at execution time<br>- Deserialize target topic and payload from task data<br>- Publish payload to target topic via Pub/Sub<br>- Mark task as completed on success<br>- Handle publish failures with retries | `Ready to Test` |  | Implemented in MessageScheduler.executeTask with error handling |
| **Dynamic Topic Routing** | Support dynamic topic routing from message payload | - Extract target topic from schedule request<br>- Validate topic exists or can be created<br>- Publish to dynamically specified topic<br>- Handle topic permission errors | `Ready to Test` |  | Implemented with TargetTopic value object supporting both simple and full topic paths |
| **Docker Deployment** | Create Dockerfile for portable deployment | - Multi-stage build for Scala application<br>- Minimal base image (JRE 11+)<br>- Environment variable configuration<br>- Health check endpoint<br>- Image builds and runs successfully | `Ready to Test` |  | Multi-stage Dockerfile created with health check on port 8080 |
| **Docker Deployment** | Implement environment-based configuration | - Database connection string from env var<br>- Pub/Sub project ID from env var<br>- Pub/Sub credentials from file path or env var<br>- Subscription name from env var<br>- Validate all required config on startup | `Ready to Test` |  | Implemented in Config.scala with Typesafe Config and env var overrides |
| **Deployment Documentation** | Create deployment guide for standing up the service | - Document Cloud SQL database provisioning<br>- Document Pub/Sub topic and subscription setup<br>- Document service account permissions required<br>- Document environment variable configuration<br>- Provide Docker run command examples<br>- Include troubleshooting section | `TODO` |  | Create DEPLOYMENT.md file with detailed setup instructions |
| **Deployment Documentation** | Document message format and API contract | - Document JSON schema for schedule request messages<br>- Provide message examples<br>- Document error handling and dead-letter queue setup<br>- Document monitoring and logging approach | `TODO` |  | Create API.md file (partially covered in docs/cli.md) |
| **Operational Health** | Implement comprehensive health check for downstream services | - Health endpoint actively checks database connectivity<br>- Health endpoint actively checks PubSub connectivity<br>- Return detailed status per service<br>- Return 503 if any service is unhealthy<br>- Include response time metrics | `Ready to Test` |  | Enhanced HealthCheckServer with DatabaseManager and PubSubClient health checks, added testConnection to PubSubClient |
| **HTTP Scheduling API** | Design secure authentication mechanism for HTTP API | - Choose authentication method (API key, JWT, mutual TLS, or IAM)<br>- Define security requirements and threat model<br>- Document key management and rotation strategy<br>- Consider rate limiting requirements<br>- Define audit logging requirements | `TODO` |  | **Decision: Use Google Cloud IAM** - Verify service account tokens via Authorization Bearer header |
| **HTTP Scheduling API** | Implement authentication middleware for HTTP endpoints | - Validate authentication tokens/keys on each request<br>- Support configurable auth providers<br>- Return 401 for unauthenticated requests<br>- Return 403 for unauthorized requests<br>- Log authentication attempts (success and failure) | `TODO` |  | Depends on authentication design |
| **HTTP Scheduling API** | Create POST /schedule endpoint for direct message scheduling | - Accept JSON schedule request in body<br>- Authenticate and authorize request<br>- Validate request using ScheduleRequestParser<br>- Schedule message using MessageScheduler<br>- Return task ID and status (201 Created)<br>- Return validation errors (400)<br>- Handle internal errors (500) | `TODO` |  | Secure HTTP endpoint for direct scheduling |
| **HTTP Scheduling API** | Implement rate limiting for HTTP API | - Per-client rate limiting based on auth identity<br>- Configurable limits (requests per minute/hour)<br>- Return 429 Too Many Requests when limit exceeded<br>- Include rate limit headers in responses | `TODO` |  | Prevent API abuse |
| **HTTP Scheduling API** | Add audit logging for HTTP API requests | - Log all authenticated requests<br>- Include client identity, timestamp, request details<br>- Log success/failure and response codes<br>- Include correlation IDs for tracing<br>- Support structured logging format | `TODO` |  | Security audit trail |

Notes:
- The `Status` column must follow: `TODO` → `In Progress` → `Ready to Test` → `Complete`.
- The `Prototype` column is maintained by the prototyping workflow. Leave it empty for new tasks. When a prototype is created, this column should include where to find it (e.g., `prototypes/[task-or-feature].[ext]`) plus a brief note on scope/findings.

